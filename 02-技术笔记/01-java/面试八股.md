[TOC]

# 说一下HashMap的put方法

hashMap的put方法的大体流程：

- 1、根据key进行哈希与与运算得到数组下标位置
- 2、如果数组下标位置元素为空，则将key和value封装为Entry对象，(jdk1.7是Entry对象，jdk1.8是Node对象)
- 3、如果数组下标位置元素不为空：
  - 3.1、jdk1.7中，首先判断是否需要扩容，如果需要扩容就扩容，如果不需要就将key和value封装为一个Entry对象，采用头插法插入当前位置的链表中
  - 3.2、jdk1.8中，则会先判断当前位置上的Node类型，看是红黑树Node类型还是链表Node类型
    - 3.2.1、如果是红黑树Node，则将key和value封装为一个红黑树节点并添加到红黑树中，在这个过程会判断红黑树是否存在key，如果存在则更新value
    - 3.2.1、如果是链表Node，则将Key和value封装为一个链表Node，采用尾插法插入当前位置链表的最后位置，因为是尾插法，会遍历整个链表，在遍历过程中，如果存在key，则更新value，遍历完链表后，将新的链表Node插入到链表中，插入链表后，如果链表节点数量大于等于8，则会将链表转换为红黑树
    - 3.2.3、将key和value封装为Node插入链表或红黑树之后，再判断是否需要扩容，如需扩容就扩容，如不需要就结束put方法