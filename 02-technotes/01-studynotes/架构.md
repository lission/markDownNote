[TOC]

# 1、架构基础

## 1.1、架构特点、本质

什么是软件架构？

软件架构是系统的草图，**将目标系统按某一规则进行切分，切分原则，是便于不同角色进行并行工作**。

软件架构的核心价值，**控制系统复杂性**，**将核心业务逻辑和技术细节分离解耦**

**单体应用架构——》垂直应用架构——》soa应用架构——》微服务架构 ——》service meash（网格服务）**

## 1.2、架构特点及应用场景

### 1.2.1、单体应用架构
all in one，开发成本、维护成本、硬件成本、运维成本低
**缺点**：容错率低，水平扩展性低
外包、学校应用可能较多

### 1.2.2、垂直应用架构
**把单体应用，拆分成互不相干的几个应用**

**缺点**：应用独立无法互相调用，存在重复的开发任务

### 1.2.3、分布式架构
**在垂直应用的基础上，将每一个应用公共模块抽取出来**，部署为一个个独立的应用
**缺点**：分布式架构，**服务之间的调用复杂**，**不易扩展和维护**

### 1.2.4、soa架构
soa架构（面向服务架构）Service-Oriented Architecture，解决分布式架构调用复杂的问题，采用**治理中心（esb**），**管理所有服务，监控服务状态，解决调用异常问题**。针对不同语言，不同协议进行协调，调节整个服务。soap基于webservice协议通信
**缺点**：

- 服务间存在依赖关系，如果服务出现问题，可能会出现**服务雪崩问题**。
- 扇形调用，**服务调用是一个扇形的结构**，如果其中**某一个节点出现问题，导致整个调用链路不可用，导致整个服务的雪崩宕机**
- 采用治理中心，中心化，使服务间强耦合，**维护扩展不易**。

### 1.2.5、微服务架构
**针对服务进行更加细粒度的拆分，拆分粒度视业务复杂度而定**。
注册中心，网关（路由服务），服务降级（解决服务雪崩问题）

### 1.2.6、分布式架构、soa架构、微服务架构区别？
微服务架构也是分布式架构，微服务架构拆分的更彻底，组件更独立
微服务架构在soa架构的一个升华，**微服务架构提供了更丰富的服务协调组件**

**微服务架构之父 马丁·福勒 Martin Fowler**
[原文地址](https://martinfowler.com/articles/microservices.html)
[译文](https://blog.csdn.net/weixin_43657264/article/details/114287258)

# 2、微服务

## 2.1、什么是微服务

微服务架构是一种**架构模式**，提倡**将单一应用程序划分成一组小的服务**，**服务之间互相协调、配合**。系统中的各个微服务可以被**独立部署**，各个微服务之间是**松耦合**的。每个微服务仅专注于完成一件任务。

每个服务运行在独立进程中，服务与服务之间采用轻量级通信机制互相沟通。

微服务本质上还是**SOA**，但是它是**分布式、去中心化**的。去掉大一统的ESB（企业服务总线），服务间轻通信，比SOA更彻底的拆分。

微服务架构强调重点是业务系统要**彻底组件化和服务化**，原有单个业务系统会拆分为多个可以独立开发、设计、运行、和运维的小应用。

## 2.2、为何使用微服务架构

- 系统复杂度可控、服务内聚、职责单一、服务间松耦合、开发效率高
- **独立部署**、发布风险低、缩短应用交付周期
- 技术选型灵活，可以根据业务场景不同选择合适的技术栈
- 容错性，**不会因为某个业务导致整个系统不可用**
- 扩展性，**可以细粒度的扩展某个业务集群**，机器资源不会浪费

## 2.3、微服务的拆分

两种方式：

- 按业务模型拆分，按业务领域拆分、按用户群体拆分等
- 按压力模型拆分，高并发业务单独一个服务，避免影响其他业务，比如：秒杀、商品详情页

## 2.4、要解决的技术问题

- 服务调用
- 负载均衡
- 服务容错、降级、限流
- 服务治理
- 链路追踪
- 统一网关
- 配置统一管理、配置热部署、消息发布（消息总线）
- 分布式会话、批量部署
